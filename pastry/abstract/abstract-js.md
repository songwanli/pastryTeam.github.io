# JS框架简介

----
## 框架设计

----
### 移动金融框架

* PT JS框架的定位为移动金融JS框架,关键词是移动、金融、和框架。

  所以在框架的设计中,考虑更多的是 移动设备上的用户体验、数据安全和代码的可维护性。

* 在框架的规划中,PT JS以手机端应用为起点,将慢慢扩展适用到各种移动设备、PC平台及智能电视。

----
### 各平台代码统一

* 实现代码的高度统一,同一份JS代码可以在多个平台系统(iOS、Android、WinPhone、PC浏览器)上执行, 提高开发效率。

----
### 支持差异化

* 提供各平台的差异化处理支持,方便开发者根据业务需求,调整代码复用和用户体验之间的平衡。

----
### 单业务单模板

* 目前比较流行SPA(单页面应用:Single Page Application)的开发模式,一个Html页面就是一个应用。

  PT JS框架借鉴这一思想,但缩小了一个Html页面的处理范围,一个Html页面处理一个业务,即单业务单 模板的思想。

  这种思想及减少了页面模板的数据量,又减小了应用的复杂度,提高了代码的可维护性。

----
### 前端MVC

PT JS采用的是前端MVC的思想。

和直接采用JQuery、Ajax的局部刷新机制相比,引入MVC的思想,以增加复杂度和上手难度为代价,提升 了代码的重用性和可维护性。

和后端MVC框架(Spring MVC、Struts)相比,有以下特点:

* 充分利用客户端资源

	* 前端MVC由客户端浏览器通过JS解析。

    * 后端MVC由服务器器通过Java解析。

* 减少数据传输

    * 前端MVC仅在页面第一次加载时需要渲染整个页面,之后请求的返回都是JSON数据,页面局部渲染。

    * 后端MVC每次返回的都是整个页面的Html数据,每次都需要渲染整个页面。

* 开发语言统一

    * 前端MVC的模板直接写在Html中,和前端展示都使用JS为开发语言,可以直接在浏览器中运行。

    * 后端MVC的模板也为独立文件,一般使用模板引擎借助Java解析,一般需要使用服务器容器才能运行,开发人员需要了解java相关知识。

----
### 概念简化

引入MVC的概念增加了框架的复杂度,为了偏于开发者理解,框架简化了一些概念。

* 本应于View(视图)一一对应的Model(数据模型),被框架简化为Simple和PTJSON两种基本数据模型。

* 弱化了Controler(控制器)和View(视图)的概念,将二者合并为组件的概念,通过事件驱动的方式处理用户交互事件。

* 使用Template(模板)来代替View(视图)。

* 框架定制了大量默认行为,如无特殊需求无需开发者配置。

----
### 高度扩展

虽然对开发者简化了概念,但框架内部机制并没有被简化,通预留的各种扩展接口,可以最大的适应业需求

----
### 提升客户体验

通过扩展组件,实现更好的用户体验。

----
### 服务开发者

客户是项目的服务对象,开发者是框架的服务对象。框架提供各种手段力求简化开发,提高项目实施效率。

----
### 服务项目管理

JS和MVC的模式为代码提供高度的自由度,为了解决代码维护问题,框架定制了各种规范,提高团队开发 代码的一致性。

----
### 人才培养

PT JS中定义了很多自有概念,也简化了很多概念,这些都是为项目实施服务的。

框架的目标也是尽量使项 目实施傻瓜化,开发者只要按照框架的规则就可以按照需求完成业务实现。

但是这些简化对开发者自身发展来说并不是一件好事,所以鼓励项目组按照实际需求定制组件,不断优化

代码,理解框架思想,发现框架中存在的问题,不断提高自己的技术。

----
## 框架组成

PT JS框架是以第三方开源库为基础实现的,核心技术为requirejs+jquery+backbone+bootstrap(可选)。

|模块           |技术      |
|-----          |-----      |
|**UI**         |bootstrap   |
|**MVC**        |backbone    |
|**API**        |jquery\underscore\iscroll\fastclick    |
|**Manager**    |requirejs    |

* requirejs

    requirejs是基于AMD规范的js加载工具库。requirejs可以通过配置一个主配置文件,自动完成页面js文件 的异步加载。加载时会根据配置描述的依赖关系,按顺序完成js文件的加载。

    使用requirejs的css插件,可完成css文件的加载管理。

* jquery

    jquery是流行的js工具函数库,提供一套跨浏览器的基础函数及DOM操作函数实现,可以大幅提高开发效率。

* backbone

    backbone是一个前端MVC框架,完成数据与视图的分离。

* bootstrap

    bootstrap是一个优秀的CSS UI框架。

----
## 框架实现的功能

PT JS框架力求接管一切与业务无关的通用事务处理,具体说主要包括以下几点:

|依赖管理   |数据管理   |页面管理   |异常处理   |原生支持   |调试支持   |
|-----    |-----   |-----   |-----   |-----   |-----   |
|JS依赖    |数据校验   |页面跳转  |校验错误   |双向异步通信 |模拟数据   |
|CSS依赖   |数据收集   |        |通信错误   |            |模拟桥   |
|调试代码   |数据请求   |        |模型错误   |            |模拟器   |
|         |数据适配   |        |组件错误   |            |远程调试   |
|         |数据填充   |        |          |            |        |
|         |数据保持   |        |          |            |         |

* 依赖管理

    页面中所有的js和css加载由框架管理,通过页面的头部的一个script标签元素配置。

* 数据管理

    * 数据校验(规划中)

        框架提供统一的数据校验解决方案,可以通过属性的配置的方式完成绝大部分数据校验工作。

        数据校验支持复杂的依赖校验,开发者借助元素属性描述数据之间的依赖关系,框架将自动进行依赖校验。

    * 数据收集

        框架借助Form组件,自动完成表单数据的收集。在Form组件的提交回调中,开发者可以得到需要的数据。

    * 数据请求

        开发者通过配置请求地址和参数,借助组件的刷新完成数据的提交和获取。

    * 数据填充

        服务器返回的数据,组件会根据data-name属性的配置,自动填充到组件的数据模型中并刷新UI

    * 数据适配

        服务器返回的数据不符合组件规定的格式时,框架提供一套数据适配流程,统一完成数据的转换工作。

    * 数据保持

        框架会维护页面中每个组件的数据,保证在页面前进后退时都可以方便的使用和清除。

* 页面跳转

    框架提供一套接口,方便管理页面的跳转和返回。

* 异常处理

    框架提供一套错误处理机制,方便在流程的各个环节捕捉和处理错误。

* 原生支持

    框架提供一套统一的和移动设备原生系统交互的接口,实现了js和原生的双向异步通信。

* 调试支持

    框架提供模拟数据及模拟数据支持,并支持远程调试。

    * 模拟数据

        通过配置模拟数据文件,开发人员可以在服务器接口尚未开发完成时进行业务开发。

    * 模拟桥&模拟器

        框架提供在网页中模拟移动设备行为的模拟器,大幅提到调试效率。

    * 远程调试(`不支持`)

        框架提供远程调试功能,可以在PC机上调试移动设备中的代码,可以即时查看变量值。
