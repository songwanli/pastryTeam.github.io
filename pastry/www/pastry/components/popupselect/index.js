console.log("def:component_popupselect"),define(["js/core","~/components/popupwindow/index","css!~/components/popupselect/style/main.css"],function(t){var e=t.api,a=t.Component,n=t.Template,i=e.$;n.PopupSelect={content:function(t){return _.template("<%if(data."+t.value+">-1){%><%=data."+t.data+"[data."+t.value+"]."+t.title+"%><%}else{%><%=data.text%><%}%>",n.outerSettings)},popupWindow:function(t){return _.template('<div class="popupselect-popup"><%for(var i=0,n=data.'+t.data+'.length;i<n;i++){%><input class="popupselect-item" type="button" value="<%=data.'+t.data+"[i]."+t.title+'%>" data-select-item="<%=i%>"/><%}%><%if(data.showCancel){%><input class="popupselect-item" type="button" value="<%=data.cancelText%>" data-select-item/><%}%></div>',n.outerSettings)}};var l=a.PopupWindow.extend({initialize:function(t){this._super.apply(this,arguments);var e=this;this.bindEvent("click [data-select-item]",function(t){var a=i(t.currentTarget).data("select-item");e.close(""===a?void 0:a)})},getExData:function(t){return this.parent.getExData(t)}});a.PopupSelect=a.Base.extend({initialize:function(t){this._super.apply(this,arguments);var a=this,i=this.model,o=i.mapping=e.getTypeVal("Object",i.mapping,{});o.value=e.getTypeVal("String",o.value,"selected"),o.data=e.getTypeVal("String",o.items,"items"),o.title=e.getTypeVal("String",o.title,"title"),this.template.ready=n.obtainTemplate(this.template.ready,n.PopupSelect.content(o)),this.bindEvent("click",function(){a.isBadClick()||"ready"===a.model.getStatus()&&new l({parent:a,onResult:function(t){a.setValue(t),a.model.proxy&&a.render()},onCancel:a.onCancel,onShow:a.onShow,onClose:a.onClose,template:n.obtainTemplate(a.$el.data("template-popup"),n.PopupSelect.popupWindow(o))}).show()}),i.exCfg={text:e.getTypeVal("String",this.$el.attr("data-text"),"请选择..."),showCancel:this.$el.data("show-cancel")===!0,cancelText:e.getTypeVal("String",this.$el.attr("data-cancel-text"),"取消")},e.bindFunctions(this,"onSelectChange","onCancel"),this.model.on("change",function(){if(_.isFunction(a.onSelectChange)){var t=a.model,e=t.getData();if(_.isArray(e)){var n=t.getValue();_.isObject(e[n])&&a.onSelectChange({item:e[n],index:n})}}})},getExData:function(t){return this.model.exCfg},reset:function(){this.setValue(-1)},getValue:function(){var t=this.model.getData();return _.isArray(t)&&this.model.getValue()>-1?t[this.model.getValue()]:null},setSelect:function(t){for(var e=!1,a=this.model.getData(),n=0;n<a.length;n++){for(var i in t){if(t[i]!=a[n][i]){e=!1;break}e=!0}if(e)return this.setValue(n),void 0}}})});