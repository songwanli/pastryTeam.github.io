var hasProp={}.hasOwnProperty;console.log("def:component_tree"),define(["js/core","~/plugins/jstree/jstree"],function(e){var t,n,s,a,r;return a=e.api,n=e.Template,s=a._,t=e.Component,r=function(e){var t,n,a,r,o,i,l,c,d,h;if(n=e.data,i=e.ref,o=e.position,t=e.callback,c=[],s.isEmpty(n))return t();for(s.isArray(n)||(n=[n]),("after"===(l=e.position)||"first"===l||"inside"===l)&&(n=n.reverse()),d=[],a=0,r=n.length;r>a;a++)h=n[a],this.getTreeTemplate(h),d.push(this.jstree.create_node(i,h,o,function(e){return c.push(e),t(c)},e.is_loaded));return d},t.Tree=t.Base.extend({initialize:function(e){var t,n,s;e.template=this.$el.html(),this._super(e),n=this.model,void 0!==n&&(t=n.mapping=a.getTypeVal("Object",n.mapping,{}),t.data=a.getTypeVal("String",t.data,"data")),s=this,this.$("[data-search-button]").length>0&&this.bindEvent("click [data-search-button]",function(){s.jstree.search(s.$("[data-search-input]").val())}),this.$("[data-search-input]").length>0&&this.bindEvent("input [data-search-input]",function(e){s.jstree.search(e.currentTarget.value)})},getTree:function(){return this.jstree},getTreeTemplate:function(e,t){var s,a,r,o,i,l;if(!t&&e.type&&(null!=(r=this.types)?r[e.type]:void 0)&&this.types[e.type].template&&(e.text=n.obtainTemplate(this.types[e.type].template,"",n.outerSettings)(e)),t||e.children&&0!==e.children.length){for(o=t?e:e.children,i=[],s=0,a=o.length;a>s;s++)l=o[s],i.push(this.getTreeTemplate(l));return i}},addNode:function(e){var t,n,a;a=this,t=e.callback,e.callback=s.debounce(function(n){var s;return(s=e.dom)&&(s.removeClass("jstree-loading").attr("aria-busy",!1),a.jstree.enable_node(s)),null!=t&&t.call(a,n),a.jstree.settings.core.data=a.jstree.get_json("#",{no_id:!0})},0),s.isFunction(e.data)?(n=this.jstree.get_node("before"===e.position||"after"===e.position?e.ref.parent:e.ref,!0),n.addClass("jstree-loading").attr("aria-busy",!0),this.jstree.disable_node(n),e.data.call(null,function(t){return e.data=t,e.dom=n,r.call(a,e)})):r.call(a,e)},afterRender:function(){var e,t,n,s,a,r,o;this._super(),"ready"===this.model.getStatus()&&(r=this,null!=(s=r.jstree)&&s.destroy(),n=[],this.getTreeTemplate(r.model.get("data"),!0),t={core:{check_callback:!0,data:r.model.get("data")},plugins:n},this.$("[data-search-button],[data-search-input]").length>0&&n.push("search"),this.sort&&(n.push("sort"),t.sort=this.sort),this.wholerow&&n.push("wholerow"),this.types&&(n.push("types"),t.types=this.types),o="css!~/plugins/jstree/themes/default/style.css",this.themes&&(this.themes.name=this.themes.name||"default","default"!==(a=this.themes.name)&&(o="css!^/plugins/jstree/themes/"+this.themes.name+"/style.css"),n.push("themes"),t.core.themes=this.themes),require([o]),this.menu&&(n.push("contextmenu"),t.contextmenu={items:function(e,t){var n,s,a,o;o=r.menu(e),s=function(t){return a.action=function(){r.onMenuAction({action:t,data:e.original,node:e})}};for(n in o)hasProp.call(o,n)&&(a=o[n],s(n));return o}}),e=r.$("[data-tree]"),e.on("load_node.jstree",function(){"function"==typeof r.onLoaded&&r.onLoaded()}).on("hover_node.jstree",function(e,t){var n;n=t.node,"function"==typeof r.onTreeItemHover&&r.onTreeItemHover({data:n.original,node:n,srcEvt:e})}).on("activate_node.jstree",function(e,t){var n;n=t.node,"function"==typeof r.onTreeItemClick&&r.onTreeItemClick({data:n.original,node:n,srcEvt:e})}).on("select_node.jstree",function(e,t){var n;n=t.node,"function"==typeof r.onTreeItemSelect&&r.onTreeItemSelect({data:n.original,node:n,srcEvt:e})}).on("dblclick.jstree",function(e){var t;t=r.jstree.get_node(e.target),"function"==typeof r.onTreeItemDblClick&&r.onTreeItemDblClick({data:t.original,node:t,srcEvt:e})}).jstree(t),r.jstree=e.jstree())}})});