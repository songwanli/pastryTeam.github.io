define(["~/lib/libex"],function(n){function r(n){var r,t,e,f;for(t=new Array(n),r=0;n>r;r++)t[r]=0;for(t[0]=2,e=0;t[e]<n;){for(r=t[e]*t[e];n>r;r+=t[e])t[r]=1;for(e++,t[e]=t[e-1]+1;t[e]<n&&t[t[e]];t[e]++);}for(f=new Array(e),r=0;e>r;r++)f[r]=t[r];return f}function t(n,r){return bn.length!==n.length&&(bn=T(n),In=T(n),mn=T(n)),j(mn,r),e(n,mn)}function e(n,r){var t,e,f,o;for(bn.length!==n.length&&(bn=T(n),In=T(n),mn=T(n)),Z(mn,r),Z(In,n),Z(bn,n),E(In,-1),E(bn,-1),f=0,t=0;t<In.length;t++)for(e=1;on>e;e<<=1)n[t]&e?(o=f<In.length+fn?f:0,t=In.length,e=on):f++;if(o&&F(In,o),tn(mn,In,n),!z(mn,1)&&!C(mn,bn)){for(e=1;o-1>=e&&!C(mn,bn);){if(nn(mn,n),z(mn,1))return 0;e++}if(!C(mn,bn))return 0}return 1}function f(n){var r,t,e;for(r=n.length-1;0===n[r]&&r>0;r--);for(t=0,e=n[r];e;e>>=1,t++);return t+=fn*r,t}function o(n,r){var t=G(0,(n.length>r?n.length:r)*fn,0);return Z(t,n),t}function l(n){var r=G(0,n,0);return y(r,n),rn(r,1)}function h(n){return n>=600?g(n,2):n>=550?g(n,4):n>=500?g(n,5):n>=400?g(n,6):n>=350?g(n,7):n>=300?g(n,9):n>=250?g(n,12):n>=200?g(n,15):n>=150?g(n,18):n>=100?g(n,27):g(n,40)}function g(n,t){var f,o,l,h;for(h=3e4,f=G(0,n,0),0===qn.length&&(qn=r(3e4)),Qn.length!==f.length&&(Qn=T(f));;){for(A(f,n,0),f[0]|=1,l=0,o=0;o<qn.length&&qn[o]<=h;o++)if(0===q(f,qn[o])&&!z(f,qn[o])){l=1;break}for(o=0;t>o&&!l;o++){for(A(Qn,n,0);!B(f,Qn);)A(Qn,n,0);e(f,Qn)||(l=1)}if(!l)return f}}function i(n,r){var t=T(n);return $(t,r),rn(t,1)}function u(n,r){var t=o(n,n.length+1);return E(t,r),rn(t,1)}function a(n,r){var t=o(n,n.length+r.length);return Y(t,r),rn(t,1)}function v(n,r,t){var e=o(n,t.length);return tn(e,rn(r,2),rn(t,2),0),rn(e,1)}function c(n,r){var t=o(n,n.length>r.length?n.length+1:r.length+1);return W(t,r),rn(t,1)}function d(n,r){var t=o(n,n.length>r.length?n.length+1:r.length+1);return X(t,r),rn(t,1)}function M(n,r){var t=o(n,r.length),e;return e=m(t,r),e?rn(t,1):null}function w(n,r,t){var e=o(n,t.length);return _(e,r,t),rn(e,1)}function y(n,e){var o,l,h,g,i,u,a,v,c,d,M;if(0===qn.length&&(qn=r(3e4)),0===Gn.length)for(Gn=new Array(512),i=0;512>i;i++)Gn[i]=Math.pow(2,i/511-1);o=.1,l=20;var w=20;if(zn.length!==n.length&&(zn=T(n),Cn=T(n),Tn=T(n),jn=T(n),Hn=T(n),Jn=T(n),Kn=T(n),Fn=T(n),En=T(n),On=T(n),Dn=T(n),Nn=T(n),Zn=T(n),Ln=T(n)),w>=e){for(h=(1<<(e+2>>1))-1,j(n,0),g=1;g;)for(g=0,n[0]=1|1<<e-1|Math.floor(Math.random()*(1<<e)),i=1;i<qn.length&&(qn[i]&h)===qn[i];i++)if(0===n[0]%qn[i]){g=1;break}return S(n),void 0}if(a=o*e*e,e>2*l)for(u=1;l>=e-e*u;)u=Gn[Math.floor(512*Math.random())];else u=.5;for(M=Math.floor(u*e)+1,y(Nn,M),j(zn,0),zn[Math.floor((e-2)/fn)]|=1<<(e-2)%fn,P(zn,Nn,On,Dn),c=f(On);;){for(;A(Cn,c,0),!B(On,Cn););for(E(Cn,1),X(Cn,On),Z(En,Nn),Y(En,Cn),K(En,2),E(En,1),Z(jn,Cn),K(jn,2),v=0,i=0;i<qn.length&&qn[i]<a;i++)if(0===q(En,qn[i])&&!z(En,qn[i])){v=1;break}if(v||t(En,2)||(v=1),!v){for(E(En,-3),i=En.length-1;0===En[i]&&i>0;i--);var s;for(d=0,s=En[i];s;s>>=1,d++);for(d+=fn*i;A(Zn,d,0),!B(En,Zn););if(E(En,3),E(Zn,2),Z(Fn,Zn),Z(Tn,En),E(Tn,-1),tn(Fn,Tn,En),E(Fn,-1),D(Fn)&&(Z(Fn,Zn),tn(Fn,jn,En),E(Fn,-1),Z(Ln,En),Z(Hn,Fn),I(Hn,En),z(Hn,1)))return Z(n,Ln),void 0}}}function s(n,r){var t,e;return t=Math.floor((n-1)/fn)+2,e=G(0,0,t),A(e,n,r),e}function A(n,r,t){var e,f;for(e=0;e<n.length;e++)n[e]=0;for(f=Math.floor((r-1)/fn)+1,e=0;f>e;e++)n[e]=Math.floor(Math.random()*(1<<fn-1));n[f-1]&=(2<<(r-1)%fn)-1,1===t&&(n[f-1]|=1<<(r-1)%fn)}function b(n,r){var t,e;return t=T(n),e=T(r),I(t,e),t}function I(n,r){var t,e,f,o,l,h,g,i,u;for(sn.length!==n.length&&(sn=T(n)),u=1;u;){for(u=0,t=1;t<r.length;t++)if(r[t]){u=1;break}if(!u)break;for(t=n.length;!n[t]&&t>=0;t--);for(e=n[t],f=r[t],o=1,l=0,h=0,g=1;f+h&&f+g;){i=Math.floor((e+o)/(f+h));var a=Math.floor((e+l)/(f+g));if(i!==a)break;un=o-i*h,o=h,h=un,un=l-i*g,l=g,g=un,un=e-i*f,e=f,f=un}l?(Z(sn,n),Q(n,r,o,l),Q(r,sn,g,h)):($(n,r),Z(sn,n),Z(n,r),Z(r,sn))}if(0!==r[0])for(un=q(n,r[0]),j(n,r[0]),r[0]=un;r[0];)n[0]%=r[0],un=n[0],n[0]=r[0],r[0]=un}function m(n,r){var t=1+2*Math.max(n.length,r.length);if(!(1&n[0]||1&r[0]))return j(n,0),0;for(pn.length!==t&&(pn=new Array(t),kn=new Array(t),xn=new Array(t),Bn=new Array(t),Pn=new Array(t),Sn=new Array(t)),Z(pn,n),Z(kn,r),j(xn,1),j(Bn,0),j(Pn,0),j(Sn,1);;){for(;!(1&pn[0]);)H(pn),1&xn[0]||1&Bn[0]?(X(xn,r),H(xn),W(Bn,n),H(Bn)):(H(xn),H(Bn));for(;!(1&kn[0]);)H(kn),1&Pn[0]||1&Sn[0]?(X(Pn,r),H(Pn),W(Sn,n),H(Sn)):(H(Pn),H(Sn));if(B(kn,pn)?(W(kn,pn),W(Pn,xn),W(Sn,Bn)):(W(pn,kn),W(xn,Pn),W(Bn,Sn)),z(pn,0)){for(;p(Pn);)X(Pn,r);return Z(n,Pn),z(kn,1)?1:(j(n,0),0)}}}function k(n,r){for(var t=1,e=0;;){if(1===n)return t;if(0===n)return 0;if(e-=t*Math.floor(r/n),r%=n,1===r)return e;if(0===r)return 0;t-=e*Math.floor(n/r),n%=r}}function p(n){return n[n.length-1]>>fn-1&1}function x(n,r,t){var e,f=n.length,o=r.length,l=o>f+t?f+t:o;for(e=o-1-t;f>e&&e>=0;e++)if(n[e]>0)return 1;for(e=f-1+t;o>e;e++)if(r[e]>0)return 0;for(e=l-1;e>=t;e--){if(n[e-t]>r[e])return 1;if(n[e-t]<r[e])return 0}return 0}function B(n,r){var t,e=n.length<r.length?n.length:r.length;for(t=n.length;t<r.length;t++)if(r[t])return 0;for(t=r.length;t<n.length;t++)if(n[t])return 1;for(t=e-1;t>=0;t--){if(n[t]>r[t])return 1;if(n[t]<r[t])return 0}return 0}function P(n,r,t,e){var f,o,l,h,g,i,u,a;for(Z(e,n),o=r.length;0===r[o-1];o--);for(a=r[o-1],u=0;a;u++)a>>=1;for(u=fn-u,J(r,u),J(e,u),f=e.length;0===e[f-1]&&f>o;f--);for(j(t,0);!x(r,e,f-o);)V(e,r,f-o),t[f-o]++;for(l=f-1;l>=o;l--){for(e[l]===r[o-1]?t[l-o]=on:t[l-o]=Math.floor((e[l]*ln+e[l-1])/r[o-1]);g=(o>1?r[o-2]:0)*t[l-o],i=g>>fn,g&=on,h=i+t[l-o]*r[o-1],i=h>>fn,h&=on,i===e[l]?h===e[l-1]?g>(l>1?e[l-2]:0):h>e[l-1]:i>e[l];)t[l-o]--;R(e,r,-t[l-o],l-o),p(e)&&(U(e,r,l-o),t[l-o]--)}F(r,u),F(e,u)}function S(n){var r,t,e,f;for(t=n.length,e=0,r=0;t>r;r++)e+=n[r],f=0,0>e&&(f=-(e>>fn),e+=f*ln),n[r]=e&on,e=(e>>fn)-f}function q(n,r){var t,e=0;for(t=n.length-1;t>=0;t--)e=(e*ln+n[t])%r;return e}function G(n,r,t){var e;e=Math.ceil(r/fn)+1,e=t>e?t:e;var f=new Array(e);return j(f,n),f}function O(n,r,t){var e,f,o,l,h,g=n.length;if(-1===r){for(o=new Array(0);;){for(l=new Array(o.length+1),f=0;f<o.length;f++)l[f+1]=o[f];if(l[0]=parseInt(n,10),o=l,e=n.indexOf(",",0),1>e)break;if(n=n.substring(e+1),0===n.length)break}return o.length<t?(l=new Array(t),Z(l,o),l):o}for(o=G(0,r*g,0),f=0;g>f&&(e=hn.indexOf(n.substring(f,f+1),0),36>=r&&e>=36&&(e-=26),!(e>=r||0>e));f++)K(o,r),E(o,e);for(g=o.length;g>0&&!o[g-1];g--);for(g=t>g+1?t:g+1,l=new Array(g),h=g<o.length?g:o.length,f=0;h>f;f++)l[f]=o[f];for(;g>f;f++)l[f]=0;return l}function z(n,r){var t;if(n[0]!==r)return 0;for(t=1;t<n.length;t++)if(n[t])return 0;return 1}function C(n,r){var t,e=n.length<r.length?n.length:r.length;for(t=0;e>t;t++)if(n[t]!==r[t])return 0;if(n.length>r.length){for(;t<n.length;t++)if(n[t])return 0}else for(;t<r.length;t++)if(r[t])return 0;return 1}function D(n){var r;for(r=0;r<n.length;r++)if(n[r])return 0;return 1}function N(n,r){var t,e,f="";if(wn.length!==n.length?wn=T(n):Z(wn,n),-1===r){for(t=n.length-1;t>0;t--)f+=n[t]+",";f+=n[0]}else for(;!D(wn);)e=L(wn,r),f=hn.substring(e,e+1)+f;return 0===f.length&&(f="0"),f}function T(n){var r=new Array(n.length);return Z(r,n),r}function Z(n,r){var t,e=n.length<r.length?n.length:r.length;for(t=0;e>t;t++)n[t]=r[t];for(t=e;t<n.length;t++)n[t]=0}function j(n,r){var t,e;for(e=r,t=0;t<n.length;t++)n[t]=e&on,e>>=fn}function E(n,r){var t,e,f,o;for(n[0]+=r,e=n.length,f=0,t=0;e>t;t++)if(f+=n[t],o=0,0>f&&(o=-(f>>fn),f+=o*ln),n[t]=f&on,f=(f>>fn)-o,!f)return}function F(n,r){var t,e=Math.floor(r/fn);if(e){for(t=0;t<n.length-e;t++)n[t]=n[t+e];for(;t<n.length;t++)n[t]=0;r%=fn}for(t=0;t<n.length-1;t++)n[t]=on&(n[t+1]<<fn-r|n[t]>>r);n[t]>>=r}function H(n){var r;for(r=0;r<n.length-1;r++)n[r]=on&(n[r+1]<<fn-1|n[r]>>1);n[r]=n[r]>>1|n[r]&ln>>1}function J(n,r){var t,e=Math.floor(r/fn);if(e){for(t=n.length;t>=e;t--)n[t]=n[t-e];for(;t>=0;t--)n[t]=0;r%=fn}if(r){for(t=n.length-1;t>0;t--)n[t]=on&(n[t]<<r|n[t-1]>>fn-r);n[t]=on&n[t]<<r}}function K(n,r){var t,e,f,o;if(r)for(e=n.length,f=0,t=0;e>t;t++)f+=n[t]*r,o=0,0>f&&(o=-(f>>fn),f+=o*ln),n[t]=f&on,f=(f>>fn)-o}function L(n,r){var t,e=0,f;for(t=n.length-1;t>=0;t--)f=e*ln+n[t],n[t]=Math.floor(f/r),e=f%r;return e}function Q(n,r,t,e){var f,o,l,h;for(l=n.length<r.length?n.length:r.length,h=n.length,o=0,f=0;l>f;f++)o+=t*n[f]+e*r[f],n[f]=o&on,o>>=fn;for(f=l;h>f;f++)o+=t*n[f],n[f]=o&on,o>>=fn}function R(n,r,t,e){var f,o,l,h;for(l=n.length<e+r.length?n.length:e+r.length,h=n.length,o=0,f=e;l>f;f++)o+=n[f]+t*r[f-e],n[f]=o&on,o>>=fn;for(f=l;o&&h>f;f++)o+=n[f],n[f]=o&on,o>>=fn}function U(n,r,t){var e,f,o,l;for(o=n.length<t+r.length?n.length:t+r.length,l=n.length,f=0,e=t;o>e;e++)f+=n[e]+r[e-t],n[e]=f&on,f>>=fn;for(e=o;f&&l>e;e++)f+=n[e],n[e]=f&on,f>>=fn}function V(n,r,t){var e,f,o,l;for(o=n.length<t+r.length?n.length:t+r.length,l=n.length,f=0,e=t;o>e;e++)f+=n[e]-r[e-t],n[e]=f&on,f>>=fn;for(e=o;f&&l>e;e++)f+=n[e],n[e]=f&on,f>>=fn}function W(n,r){var t,e,f;for(f=n.length<r.length?n.length:r.length,e=0,t=0;f>t;t++)e+=n[t]-r[t],n[t]=e&on,e>>=fn;for(t=f;e&&t<n.length;t++)e+=n[t],n[t]=e&on,e>>=fn}function X(n,r){var t,e,f;for(f=n.length<r.length?n.length:r.length,e=0,t=0;f>t;t++)e+=n[t]+r[t],n[t]=e&on,e>>=fn;for(t=f;e&&t<n.length;t++)e+=n[t],n[t]=e&on,e>>=fn}function Y(n,r){var t;for(an.length!==2*n.length&&(an=new Array(2*n.length)),j(an,0),t=0;t<r.length;t++)r[t]&&R(an,n,r[t],t);Z(n,an)}function $(n,r){dn.length!==n.length?dn=T(n):(Z(dn,n),Mn.length!==n.length,Mn=T(n)),P(dn,r,Mn,n)}function _(n,r,t){var e;for(vn.length!==2*n.length&&(vn=new Array(2*n.length)),j(vn,0),e=0;e<r.length;e++)r[e]&&R(vn,n,r[e],e);$(vn,t),Z(n,vn)}function nn(n,r){var t,e,f,o,l;for(o=n.length;o>0&&!n[o-1];o--);for(l=o>r.length?2*o:2*r.length,vn.length!==l&&(vn=new Array(l)),j(vn,0),t=0;o>t;t++){for(f=vn[2*t]+n[t]*n[t],vn[2*t]=f&on,f>>=fn,e=t+1;o>e;e++)f=vn[t+e]+2*n[t]*n[e]+f,vn[t+e]=f&on,f>>=fn;vn[t+o]=f}$(vn,r),Z(n,vn)}function rn(n,r){var t,e;for(t=n.length;t>0&&!n[t-1];t--);return e=new Array(t+r),Z(e,n),e}function tn(n,r,t){var e,f,o,l;if(yn.length!==t.length&&(yn=T(t)),0!==(1&t[0])){for(j(yn,0),o=t.length;o>0&&!t[o-1];o--);for(l=ln-k(q(t,ln),ln),yn[o]=1,_(n,yn,t),cn.length!==n.length?cn=T(n):Z(cn,n),e=r.length-1;e>0&!r[e];e--);if(0===r[e])return j(n,1),void 0;for(f=1<<fn-1;f&&!(r[e]&f);f>>=1);for(;;){if(!(f>>=1)){if(e--,0>e)return en(n,gn,t,l),void 0;f=1<<fn-1}en(n,n,t,l),f&r[e]&&en(n,cn,t,l)}}else for(Z(yn,n),j(n,1);!z(r,0);)1&r[0]&&_(n,yn,t),L(r,2),nn(yn,t)}function en(n,r,t,e){var f,o,l,h,g,i,u=t.length,a=r.length;for(An.length!==u&&(An=new Array(u)),j(An,0);u>0&&0===t[u-1];u--);for(;a>0&&0===r[a-1];a--);for(i=An.length-1,f=0;u>f;f++){for(g=An[0]+n[f]*r[0],h=(g&on)*e&on,l=g+h*t[0]>>fn,g=n[f],o=1;a-4>o;)l+=An[o]+h*t[o]+g*r[o],An[o-1]=l&on,l>>=fn,o++,l+=An[o]+h*t[o]+g*r[o],An[o-1]=l&on,l>>=fn,o++,l+=An[o]+h*t[o]+g*r[o],An[o-1]=l&on,l>>=fn,o++,l+=An[o]+h*t[o]+g*r[o],An[o-1]=l&on,l>>=fn,o++,l+=An[o]+h*t[o]+g*r[o],An[o-1]=l&on,l>>=fn,o++;for(;a>o;)l+=An[o]+h*t[o]+g*r[o],An[o-1]=l&on,l>>=fn,o++;for(;u-4>o;)l+=An[o]+h*t[o],An[o-1]=l&on,l>>=fn,o++,l+=An[o]+h*t[o],An[o-1]=l&on,l>>=fn,o++,l+=An[o]+h*t[o],An[o-1]=l&on,l>>=fn,o++,l+=An[o]+h*t[o],An[o-1]=l&on,l>>=fn,o++,l+=An[o]+h*t[o],An[o-1]=l&on,l>>=fn,o++;for(;u>o;)l+=An[o]+h*t[o],An[o-1]=l&on,l>>=fn,o++;for(;i>o;)l+=An[o],An[o-1]=l&on,l>>=fn,o++;An[o-1]=l&on}B(t,An)||W(An,t),Z(n,An)}var fn=0,on=0,ln=on+1,hn="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_=!@#$%^&*()[]{}|;:,.<>/?`~ \\'\"+-";for(fn=0;1<<fn+1>1<<fn;fn++);fn>>=1,on=(1<<fn)-1,ln=on+1;var gn=G(1,1,1),un=new Array(0),an=un,vn=un,cn=un,dn=un,Mn=un,wn=un,yn=un,sn=un,An=un,bn=un,In=un,mn=un,kn=un,pn=un,xn=un,Bn=un,Pn=un,Sn=un,qn=un,Gn=un,On=un,zn=un,Cn=un,Dn=un,Nn=un,Tn=un,Zn=un,jn=un,En=un,Fn=un,Hn=un,Jn=un,Kn=un,Ln=un,Qn=un;return n.BigInt={getBitSize:f,isNegative:p,copy:T,equals:C,equalsInt:z,isGreater:B,isZero:D,leftShift:J,rightShift:F,add:d,addInt:u,sub:c,mult:a,divide:P,inverseMod:M,inverseModInt:k,mod:i,modInt:q,powMod:v,multMod:w,randProbPrime:h,randTruePrime:l,randBigInt:s,int2bigInt:function(n,r,t){return r=r||64,t=t||16,G(n,r,t)},bigInt2str:function(n,r){return r=r||10,N(n,r)},str2bigInt:function(n,r,t){return r=r||10,t=t||16,O(n,r,t)},GCD:b},n.BigInt});