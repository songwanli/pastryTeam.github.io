!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function n(n){if(n.getOption("disableInput"))return e.Pass;for(var o=n.listSelections(),i,r=[],l=0;l<o.length;l++){var m=o[l].head,s=n.getTokenAt(m);if("comment"!=s.type)return e.Pass;var c=e.innerMode(n.getMode(),s.state).mode;if(i){if(i!=c)return e.Pass}else i=c;var f=null;if(i.blockCommentStart&&i.blockCommentContinue){var a=s.string.indexOf(i.blockCommentEnd),u=n.getRange(e.Pos(m.line,0),e.Pos(m.line,s.end)),d;if(-1!=a&&a==s.string.length-i.blockCommentEnd.length&&m.ch>=a);else if(0==s.string.indexOf(i.blockCommentStart)){if(f=u.slice(0,s.start),!/^\s*$/.test(f)){f="";for(var C=0;C<s.start;++C)f+=" "}}else-1!=(d=u.indexOf(i.blockCommentContinue))&&d+i.blockCommentContinue.length>s.start&&/^\s*$/.test(u.slice(0,d))&&(f=u.slice(0,d));null!=f&&(f+=i.blockCommentContinue)}if(null==f&&i.lineComment&&t(n)){var g=n.getLine(m.line),d=g.indexOf(i.lineComment);d>-1&&(f=g.slice(0,d),/\S/.test(f)?f=null:f+=i.lineComment+g.slice(d+i.lineComment.length).match(/^\s*/)[0])}if(null==f)return e.Pass;r[l]="\n"+f}n.operation(function(){for(var e=o.length-1;e>=0;e--)n.replaceRange(r[e],o[e].from(),o[e].to(),"+insert")})}function t(e){var n=e.getOption("continueComments");return n&&"object"==typeof n?n.continueLineComment!==!1:!0}for(var o=["clike","css","javascript"],i=0;i<o.length;++i)e.extendMode(o[i],{blockCommentContinue:" * "});e.defineOption("continueComments",null,function(t,o,i){if(i&&i!=e.Init&&t.removeKeyMap("continueComment"),o){var r="Enter";"string"==typeof o?r=o:"object"==typeof o&&o.key&&(r=o.key);var l={name:"continueComment"};l[r]=n,t.addKeyMap(l)}})});