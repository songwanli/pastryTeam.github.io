!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("tiddlywiki",function(){function e(e,t,r){return t.tokenize=r,r(e,t)}function t(t,l){var y=t.sol(),$;if(l.block=!1,$=t.peek(),y&&/[<\/\*{}\-]/.test($)){if(t.match(w))return l.block=!0,e(t,l,i);if(t.match(k))return"quote";if(t.match(d)||t.match(h))return"comment";if(t.match(p)||t.match(b)||t.match(v)||t.match(g))return"comment";if(t.match(s))return"hr"}if($=t.next(),y&&/[\/\*!#;:>|]/.test($)){if("!"==$)return t.skipToEnd(),"header";if("*"==$)return t.eatWhile("*"),"comment";if("#"==$)return t.eatWhile("#"),"comment";if(";"==$)return t.eatWhile(";"),"comment";if(":"==$)return t.eatWhile(":"),"comment";if(">"==$)return t.eatWhile(">"),"quote";if("|"==$)return"header"}if("{"==$&&t.match(/\{\{/))return e(t,l,i);if(/[hf]/i.test($)&&/[ti]/i.test(t.peek())&&t.match(/\b(ttps?|tp|ile):\/\/[\-A-Z0-9+&@#\/%?=~_|$!:,.;]*[A-Z0-9+&@#\/%=~_|$]/i))return"link";if('"'==$)return"string";if("~"==$)return"brace";if(/[\[\]]/.test($)&&t.peek()==$)return t.next(),"brace";if("@"==$)return t.eatWhile(m),"link";if(/\d/.test($))return t.eatWhile(/\d/),"number";if("/"==$){if(t.eat("%"))return e(t,l,r);if(t.eat("/"))return e(t,l,o)}if("_"==$&&t.eat("_"))return e(t,l,a);if("-"==$&&t.eat("-")){if(" "!=t.peek())return e(t,l,u);if(" "==t.peek())return"brace"}if("'"==$&&t.eat("'"))return e(t,l,n);if("<"!=$)return null;if(t.eat("<"))return e(t,l,f);t.eatWhile(/[\w\$_]/);var x=t.current(),z=c.propertyIsEnumerable(x)&&c[x];return z?z.style:null}function r(e,r){for(var n=!1,i;i=e.next();){if("/"==i&&n){r.tokenize=t;break}n="%"==i}return"comment"}function n(e,r){for(var n=!1,i;i=e.next();){if("'"==i&&n){r.tokenize=t;break}n="'"==i}return"strong"}function i(e,r){var n=r.block;return n&&e.current()?"comment":!n&&e.match($)?(r.tokenize=t,"comment"):n&&e.sol()&&e.match(y)?(r.tokenize=t,"comment"):(e.next(),"comment")}function o(e,r){for(var n=!1,i;i=e.next();){if("/"==i&&n){r.tokenize=t;break}n="/"==i}return"em"}function a(e,r){for(var n=!1,i;i=e.next();){if("_"==i&&n){r.tokenize=t;break}n="_"==i}return"underlined"}function u(e,r){for(var n=!1,i;i=e.next();){if("-"==i&&n){r.tokenize=t;break}n="-"==i}return"strikethrough"}function f(e,r){var n,i,o;return"<<"==e.current()?"macro":(n=e.next(),n?">"==n&&">"==e.peek()?(e.next(),r.tokenize=t,"macro"):(e.eatWhile(/[\w\$_]/),i=e.current(),o=l.propertyIsEnumerable(i)&&l[i],o?(o.style,i):(null,i)):(r.tokenize=t,null))}var c={},l=function(){function e(e){return{type:e,style:"macro"}}return{allTags:e("allTags"),closeAll:e("closeAll"),list:e("list"),newJournal:e("newJournal"),newTiddler:e("newTiddler"),permaview:e("permaview"),saveChanges:e("saveChanges"),search:e("search"),slider:e("slider"),tabs:e("tabs"),tag:e("tag"),tagging:e("tagging"),tags:e("tags"),tiddler:e("tiddler"),timeline:e("timeline"),today:e("today"),version:e("version"),option:e("option"),"with":e("with"),filter:e("filter")}}(),m=/[\w_\-]/i,s=/^\-\-\-\-+$/,d=/^\/\*\*\*$/,h=/^\*\*\*\/$/,k=/^<<<$/,p=/^\/\/\{\{\{$/,b=/^\/\/\}\}\}$/,v=/^<!--\{\{\{-->$/,g=/^<!--\}\}\}-->$/,w=/^\{\{\{$/,y=/^\}\}\}$/,$=/.*?\}\}\}/;return{startState:function(){return{tokenize:t,indented:0,level:0}},token:function(e,t){if(e.eatSpace())return null;var r=t.tokenize(e,t);return r},electricChars:""}}),e.defineMIME("text/x-tiddlywiki","tiddlywiki")});