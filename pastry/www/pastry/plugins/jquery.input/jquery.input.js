!function(){var e,t;t=this,e=function(e,t){var n,a,r,i,l,o;return n=void 0,t(document).on("click touchend",e.debounce(function(e){var t;n&&(t=e.target,n[0]!==t&&0===n.find(t).length&&n.trigger("blur"))},100)),i=function(){var e,t,n,a,r,i,l,o,s;for(o=window.getSelection(),s=o+"",r=s.length,l=0,t=0;;){if(o.modify("extend","backward","character"),0===l&&s.length>(o+"").length&&(e=!0),s===o+"")break;l++,s=o+"",e&&0===(o+"").length&&(t=l)}for(n=a=0,i=l;i>=0?i>a:a>i;n=i>=0?++a:--a)o.modify("extend","forward","character");return o={start:l-t,end:e?l:l+r,length:r,text:o+""}},l=function(n){var a,r,l,o,s,u,c,d,h,p;if(a=t(n),!a.is("input")&&!a.is("textarea"))return s=a.val().length,{start:s,end:s,length:s,text:a.val()};if("selectionStart"in n)try{return l=n.selectionEnd-n.selectionStart,{start:n.selectionStart,end:n.selectionEnd,length:l,text:n.value.substr(n.selectionStart,l)}}catch(r){return i()}else if(document.selection)return n.focus(),o=document.selection.createRange(),u="function"==typeof n.createTextRange?n.createTextRange():void 0,e.isUndefined(u)||(c=u.duplicate(),c.moveToBookmark(o.getBookmark()),u.setEndPoint("EndToStart",c)),null===o||null===u||void 0===u?{start:n.value.length,end:n.value.length,length:0,text:""}:(d=o.text.replace(/[\r\n]/g,"."),h=n.value.replace(/[\r\n]/g,"."),p=h.indexOf(d,u.text.length),{start:p,end:p+d.length,length:d.length,text:d})},a=function(){function a(a,r){var i,l,o,s;e.extend(this,r),this.$el=i=t(a).addClass("fw-input"),this.menmeryVal="",this.isInput=i.is("input")||i.is("textarea"),this.isInput?"Microsoft Internet Explorer"===navigator.appName&&"MSIE9.0"===navigator.appVersion.split(";")[1].replace(/[ ]/g,"")&&setInterval(function(){i.trigger("input")},200):(l=t('<table cellspacing="0" cellpadding="0" border="0">\n  <tr>\n    <td class="fw-text-wrap"><span data-text class="fw-text"></span></td>\n    <td class="fw-cursor-wrap">\n      <img data-cursor\n        class="fw-i-img"\n        style="display: none">\n    </td>\n    <td class="fw-placeholder-wrap"><span data-placeholder class="fw-placeholder"></span></td>\n  </tr>\n</table>'),this.$text=l.find("[data-text]"),o=l.find("[data-cursor]"),this.$placeholder=l.find("[data-placeholder]"),this.$placeholder.text(i.attr("placeholder")||""),i.addClass("fw-input-div").append(l).css({overflow:"hidden"}).on("click touchend",e.debounce(function(){n&&n.trigger("blur"),n=i,o.show(),i.scrollLeft(9999)},100)).on("blur",function(){return t(this).find("[data-cursor]").hide()})),s=this,i.on("input propertychange",function(e){var t;return t=i.val(),s.menmeryVal!==t?(s.onInput(e,t+""),!0):void 0}).on("drop",function(){return!1})}return a.prototype.onInput=function(e,n){var a,r,i,l,o;if(r=e.currentTarget,a=t(r),l=this._checkInput(r,n),this.menmeryVal!==l.value&&("function"==typeof this.onInputChange&&this.onInputChange(l.value,e),this.menmeryVal=l.value),this.isInput){if(l.isFixed&&(r.value=l.value,!l.exp))try{return r.setSelectionRange?(r.focus(),r.setSelectionRange(l.endPos,l.endPos)):r.createTextRange&&(o=r.createTextRange(),o.collapse(!0),o.moveEnd("character",l.endPos),o.moveStart("character",l.endPos),o.select()),!1}catch(i){return e=i,void 0}}else this.$text.text(l.value),a.val(l.value),""===l.value?this.$placeholder.show():this.$placeholder.hide(),a.scrollLeft(9999)},a.prototype.checkInput=function(){return!0},a.prototype._checkInput=function(n,a){var r,i,o,s,u,c,d;switch(r=t(n),c=e.isNull(n)?{end:a.length}:l(n),d=a.slice(c.end),s={value:a,endPos:c.end,isFixed:!1,exp:!1},o=a.length-r.attr("maxlength"),!1){case!(r.is("[type*=number]")||!this.isInput&&o>0):t.extend(s,{value:this.getValue(),endPos:c.end-1});break;case!e.isObject(u=this.checkInput(null,null,a)):t.extend(s,{value:u.value,endPos:u.pos,exp:!0});break;case!!e.isBoolean(u):t.extend(s,{value:u,endPos:c.end,exp:!0});break;case u!==!1:for(i=a;!this.checkInput(null,null,i)&&i;)t.extend(s,{value:i=i.slice(0,c.end-=1)+d,endPos:c.end})}return s.value!==a&&(s.isFixed=!0),s},a.prototype.setValue=function(e){this.$el.val(this._checkInput(null,e||"").value).trigger("input")},a.prototype.getValue=function(){return this.$el.is("[data-encryptor]")?this.$el.data("value")||"":this.$el.val()||""},a}(),r=function(e){var n;return n=null,this.each(function(){var r,i;return r=t(this),n=r.data("input"),i="object"==typeof e&&e,n?void 0:r.data("input",n=new a(this,i))}),"string"==typeof e&&null!=n?n[e]():void 0},o=t.fn.input,t.fn.input=r,t.fn.input.Constructor=a,t.fn.input.noConflict=function(){return t.fn.input=o,this}},"undefined"!=typeof define&&define.amd?define(["underscore","jquery"],function(t,n){e(t,n)}):e(t._,t.jQuery)}();